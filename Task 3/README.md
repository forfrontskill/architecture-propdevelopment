## Требования к безопасности

1. Использование TLS-шифрования, аутентификация при подключении к ЕБС (Хранилищу биометрии).
2. Авторизация и аутентификация при подключении к сторонним сервисам управления шлагбаумом и домофонами по протоколу **OAuth 2.0**. Шифрование канала подключения по **HTTPS (mTLS)**.
3. Не хранить данные биометрии на серверах.

---

## Расширение схемы

1. Добавлена отдельная сетевая зона для умного дома.
2. Сервис `device-integration` получает и обрабатывает события и запросы от устройств (шлагбаум, домофон).
3. События поступают в топик `device-events` для обработки другими сервисами.
4. Сервис регистрации устройств и отслеживания их состояния — `device-control`.
5. Сервис управления умным домом — `home-control`.

---

## Открытие шлагбаума

1. Событие о подъезде к шлагбауму поступает в топик.
2. Сервис `home-control` запрашивает номер машины из данных CRM.
3. Если машина зарегистрирована, извлекаются параметры шлагбаума из сервиса `device-control`, после чего отправляется запрос на открытие в сервис `device-integration`.

---

## Открытие двери при помощи домофона

1. Сервис домофона формирует запрос/событие с камеры в сервис `device-integration`. В событии содержится фотография пользователя.
2. Сервис `device-integration` формирует событие в топик с фотографией.
3. Сервис `home-control` передаёт данные в сервис `auth-service-1` для поиска пользователя по биометрии.
4. Сервис `auth-service-1` отправляет запрос в хранилище биометрии (ЕБС) для подтверждения личности пользователя.
5. `auth-service-1` возвращает информацию о пользователе, если он найден.
6. `home-control` проверяет доступ пользователя в подъезд по данным из CRM.
7. В случае успеха происходит открытие двери через домофон путём отправки запроса в сервис `device-integration`.
